plugins:
  sites:
    - id: "default"
      url: "https://updates.jenkins.io/update-center.json"
jenkins:
  agentProtocols:
    - "JNLP4-connect"
    - "Ping"
  authorizationStrategy:
    globalMatrix:
      grantedPermissions:
        - "Overall/Read:authenticated"
        - "Overall/Read:Administrators"
        - "Overall/Administer:chriso"
        - "Overall/Administer:Administrators"
  crumbIssuer:
    standard:
      excludeClientIPFromCrumb: false
  disableRememberMe: false
  mode: NORMAL
  nodes:
{% for slave in groups['slaves'] %}
    - permanent:
        launcher:
          sSHLauncher:
            credentialsId: "docker_slave_jenkins_user_ssh_key"
            host: "{{ hostvars[slave]['ec2_public_dns_name'] }}"
            launchTimeoutSeconds: 210
            maxNumRetries: 10
            port: 22
            retryWaitTime: 15
        name: "{{ hostvars[slave]['ec2_tag_full_name'] }}"
        labelString: "docker"
        numExecutors: 2
        remoteFS: "/home/jenkins"
{% endfor %}
    - permanent:
        launcher:
          jnlp:
            workDirSettings:
              disabled: false
              failIfWorkDirIsMissing: false
              internalDir: "remoting"
        name: "{{ windows_rust_slave_full_name }}"
        labelString: "windows"
        numExecutors: 2
        # This variable must be without quotes for the Windows style path
        remoteFS: {{ windows_rust_slave_working_path }}
  numExecutors: 2
  primaryView:
    all:
      name: "all"
  quietPeriod: 5
  scmCheckoutRetryCount: 0
  securityRealm:
    local:
      allowsSignup: false
      enableCaptcha: false
      users:
        - id: "{{ jenkins_admin_user }}"
          password: ${secret_jenkins_admin_user_password}
  slaveAgentPort: 50000
  views:
    - all:
        name: "all"
  remotingSecurity:
    enabled: true
tool:
  git:
    installations:
      - home: "git"
        name: "Default"
security:
  remotingCLI:
    enabled: false
credentials:
  system:
    domainCredentials:
      - credentials:
        - basicSSHUserPrivateKey:
            id: "docker_slave_jenkins_user_ssh_key"
            privateKeySource:
              directEntry:
                privateKey: ${secret_docker_slave_ssh_key}
            scope: GLOBAL
            username: "jenkins"
        - usernamePassword:
            id: "aws_jenkins_user_credentials"
            password: ${secret_aws_jenkins_secret_key}
            scope: GLOBAL
            username: "{{ aws_jenkins_access_key }}"
