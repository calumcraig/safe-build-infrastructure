---
- hosts: masters:wireguard
  become: True
  roles:
    - pip
    - {
        role: format_disk,
        block_device: "{{ docker_storage_block_device }}",
        mount_info: {
          name: "{{ docker_storage_mount_point }}",
          owner: "root",
          group: "root",
          mode: 0755
        },
        when: cloud_environment == "prod"
      }
    - docker
    - { role: wireguard, when: cloud_environment == "prod" }
    - { role: wireguard-server, when: cloud_environment == "prod" }
    - {
        role: format_disk,
        block_device: "{{ jenkins_workspace_block_device }}",
        mount_info: {
          name: "{{ jenkins_workspace_mount_point }}",
          owner: "root",
          group: "root",
          mode: 0755
        },
        when: cloud_environment == "prod"
      }
    - jenkins-master
